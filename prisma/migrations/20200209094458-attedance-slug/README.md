# Migration `20200209094458-attedance-slug`

This migration has been generated by nampdn at 2/9/2020, 9:44:58 AM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
ALTER TABLE "public"."User" ADD COLUMN "permission" integer  NOT NULL DEFAULT 0;

ALTER TABLE "public"."Activity" DROP COLUMN "type";

ALTER TABLE "public"."Attendance" ADD COLUMN "slug" text  NOT NULL DEFAULT '';

CREATE UNIQUE INDEX "Attendance.slug" ON "public"."Attendance"("slug")
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200131215046-add-slug-for-activity..20200209094458-attedance-slug
--- datamodel.dml
+++ datamodel.dml
@@ -1,11 +1,11 @@
-generator photon {
-  provider = "photonjs"
+generator client {
+  provider = "prisma-client-js"
 }
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url      = env("DATABASE_URL")
 }
 model Post {
   id        String   @default(cuid()) @id
@@ -17,14 +17,15 @@
   author    User?
 }
 model User {
-  id       String   @default(cuid()) @id
-  email    String   @unique
-  password String
-  name     String?
-  posts    Post[]
-  profile  Profile? @relation(name: "UserProfile")
+  id         String   @default(cuid()) @id
+  email      String   @unique
+  password   String
+  permission Int
+  name       String?
+  posts      Post[]
+  profile    Profile? @relation(name: "UserProfile")
 }
 model Profile {
   id           String       @default(cuid()) @id
@@ -81,20 +82,21 @@
 model Activity {
   id   String @default(cuid()) @id
   slug String @unique
   name String
-  type String
   org  Org
 }
 model Schedule {
-  id       String   @default(cuid()) @id
-  activity Activity @relation(name: "ScheduleActivity")
-  date     DateTime
+  id          String       @default(cuid()) @id
+  activity    Activity     @relation(name: "ScheduleActivity")
+  attendances Attendance[] @relation(name: "AttendanceSchedule")
+  date        DateTime
 }
 model Attendance {
   id        String   @default(cuid()) @id
+  slug      String   @unique
   schedule  Schedule @relation(name: "AttendanceSchedule")
   member    Profile  @relation(name: "AttendanceProfile")
   status    String
   present   Boolean
```


